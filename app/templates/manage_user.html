<!doctype html>
<html>
<head>
  <title>Manage Users</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="dashboard">
    <h1>All Registered Users</h1>

    <form method="GET">
      <input type="text" name="search" value="{{ search }}" placeholder="Search username">
      <button type="submit" class="btn">Search</button>
    </form>

    <table border="1" width="100%" style="margin-top: 20px; border-collapse: collapse;">
      <tr style="background: #ddd;">
        <th>ID</th>
        <th>Username</th>
        <th>Email</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
      {% for user in users.items %}
      <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.role }}</td>
        <td>
          <a href="{{ url_for('main.edit_user', user_id=user.id) }}" class="btn">✏️ Edit</a>
          <form action="{{ url_for('main.delete_user', user_id=user.id) }}" method="POST" style="display:inline;">
            <button class="btn" style="background: crimson;" onclick="return confirm('Are you sure?')">🗑️ Delete</button>
            <select name="role">
  <option value="">All Roles</option>
  <option value="admin" {% if role_filter == 'admin' %}selected{% endif %}>Admin</option>
  <option value="user" {% if role_filter == 'user' %}selected{% endif %}>User</option>
</select>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>

    <div style="margin-top: 20px;">
      {% if users.has_prev %}
        <a href="{{ url_for('main.manage_users', page=users.prev_num, search=search) }}" class="btn">⬅ Prev</a>
      {% endif %}
      <span>Page {{ users.page }} of {{ users.pages }}</span>
      {% if users.has_next %}
        <a href="{{ url_for('main.manage_users', page=users.next_num, search=search) }}" class="btn">Next ➡</a>
      {% endif %}
    </div>
  </div>
</body>
</html>
